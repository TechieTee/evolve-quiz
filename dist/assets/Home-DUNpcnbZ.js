import{R as T,j as e,r as o}from"./index-Dr9rvuUi.js";const V="/assets/body-front-pOEcJjsO.svg",_=({areasResponse:l,onSelect:x,selectedAreas:p,isLoading:m=!1,showFrontView:i})=>{const[d,j]=T.useState(null),v=()=>{if(m)return[];if(!Array.isArray(l))return[];if(l.length<2)return[];const r=i?l[1]:l[0];return(r==null?void 0:r.children)||[]},c=T.useMemo(()=>v(),[l,i,m,v]),f=r=>{r.count===0?j(`No conditions available for ${r.name}.`):(j(null),x(r))};return m?e.jsxs("div",{className:"area-selection-loading",children:[e.jsx("div",{className:"loading-animation"}),e.jsx("p",{children:"Loading body areas..."})]}):Array.isArray(l)?e.jsxs("div",{className:"area-selection-container",children:[d&&e.jsx("div",{className:"info-message",children:d}),e.jsxs("div",{className:"area-selection-grid",children:[c.length>0?c.map(r=>e.jsx("button",{onClick:()=>f(r),className:`area-button ${p.some(g=>g.id===r.id)?"active":""}`,children:e.jsx("span",{className:"area-name",children:r.name})},r.id)):e.jsx("div",{className:"empty-state",children:e.jsxs("p",{children:["No ",i?"front":"back"," areas available"]})}),e.jsx("img",{src:V,alt:"FrontBody"})]})]}):e.jsxs("div",{className:"area-selection-error",children:[e.jsx("div",{className:"error-icon",children:"!"}),e.jsx("p",{className:"error-message",children:l.message}),e.jsx("button",{className:"retry-button",onClick:()=>window.location.reload(),children:"Try Again"})]})},J=({conditions:l=[],bodypart:x,onSelect:p,selectedConditions:m})=>!l||l.length===0?e.jsx("div",{className:"condition-empty-state",children:"No conditions available for this body part"}):e.jsxs("div",{className:"condition-container",children:[e.jsxs("h3",{className:"concerns-header-text",children:[x," Concerns"]}),e.jsx("div",{className:"condition-grid",children:l.map(i=>e.jsx("div",{className:`condition-item ${m.some(d=>d.id===i.id)?"selected":""}`,onClick:()=>p(i),children:e.jsxs("div",{className:"condition-content",children:[e.jsx("span",{className:"condition-title",children:i.title}),e.jsxs("span",{className:`custom-checkbox ${m.some(d=>d.id===i.id)?"checked":""}`,children:[" ",m.some(d=>d.id===i.id)&&e.jsx("svg",{className:"check-icon",xmlns:"http://www.w3.org/2000/svg",width:"10",height:"10",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("polyline",{points:"20 6 9 17 4 12"})})]})]})},i.id))})]}),W=()=>{const[l,x]=o.useState([]),[p,m]=o.useState([]),[i,d]=o.useState(null),[j,v]=o.useState([]),[c,f]=o.useState([]),[r,g]=o.useState(!0),[E,q]=o.useState(null),[C,F]=o.useState(!0),[D,y]=o.useState(!1),[M,b]=o.useState(!1),[k,A]=o.useState(null),[u,z]=o.useState({name:"",email:"",phone:"",areas:"",conditions:"",consent:!1}),P=async()=>{var n,s;g(!0);try{const a=await fetch("https://evolvequizdev.wpengine.com/wp-json/wp-evolve-body-quiz/v1/areas",{headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include"});if(!a.ok){const h=await a.json();throw new Error(h.message||"Failed to fetch areas")}const t=await a.json();x(t),F(((s=(n=t[1])==null?void 0:n.children)==null?void 0:s.length)>0)}catch(a){const t=a instanceof Error?a.message:"Unknown error";x({message:t}),q(t)}finally{g(!1)}},I=async n=>{g(!0);try{const s=await fetch(`https://evolvequizdev.wpengine.com/wp-json/wp-evolve-body-quiz/v1/conditions?area=${n}`,{headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include"});if(!s.ok){const t=await s.json();throw new Error(t.message||"Failed to fetch conditions")}const a=await s.json();v(a||[])}catch(s){const a=s instanceof Error?s.message:"Failed to load conditions";q(a),v([])}finally{g(!1)}};o.useEffect(()=>{P()},[]),o.useEffect(()=>{i&&I(i.id)},[i]);const L=n=>{d(n),y(!1),b(!1),p.some(s=>s.id===n.id)||m(s=>[...s,n])},O=()=>{F(!C),d(null),y(!1),b(!1)},B=()=>{if(i&&j.length>0){const n=c.findIndex(s=>s.area.id===i.id);n>=0?f(s=>s.map((a,t)=>t===n?{...a,conditions:[...a.conditions]}:a)):f(s=>[...s,{area:i,conditions:[]}])}y(!0),d(null)},$=()=>{b(!0),A(null)};o.useEffect(()=>{c.length>0&&z(n=>({...n,areas:c.map(s=>s.area.name).join(", "),conditions:c.flatMap(s=>s.conditions.map(a=>a.title)).join(", ")}))},[c]);const w=n=>{const{name:s,value:a,type:t,checked:h}=n.target;z(N=>({...N,[s]:t==="checkbox"?h:a}))},H=n=>{n.preventDefault();const s=new Date().toLocaleString(),a=c.map(t=>({bodyArea:t.area.name,conditions:t.conditions.map(h=>h.title),services:t.conditions.flatMap(h=>{var N;return((N=h.recommended_services)==null?void 0:N.map(S=>S.title))||[]})}));A({...u,date:s,groupedData:a}),b(!1),y(!1)},U=n=>{i&&f(s=>{const a=s.findIndex(t=>t.area.id===i.id);return a>=0?s.map((t,h)=>{if(h===a){const N=t.conditions.some(S=>S.id===n.id);return{...t,conditions:N?t.conditions.filter(S=>S.id!==n.id):[...t.conditions,n]}}return t}):[...s,{area:i,conditions:[n]}]})},Y=()=>{if(!i)return[];const n=c.find(s=>s.area.id===i.id);return n?n.conditions:[]},Q=()=>{A(null),m([]),f([]),d(null),y(!1),b(!1)};if(E)return e.jsxs("div",{className:"error-message",children:["Error: ",E]});const R=()=>k?null:M?e.jsx("div",{className:"consultation-form",children:e.jsxs("div",{className:"form-container",children:[e.jsx("h3",{children:"Complete your Consultation"}),e.jsxs("form",{onSubmit:H,children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"name",children:"Name"}),e.jsx("input",{type:"text",id:"name",name:"name",value:u.name,onChange:w,required:!0,placeholder:"Enter your full name"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"email",children:"Email"}),e.jsx("input",{type:"email",id:"email",name:"email",value:u.email,onChange:w,required:!0,placeholder:"Enter your email"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"phone",children:"Phone"}),e.jsx("input",{type:"tel",id:"phone",name:"phone",value:u.phone,onChange:w,required:!0,placeholder:"Enter your phone number"})]}),e.jsxs("div",{className:"form-group checkbox-group",children:[e.jsx("input",{type:"checkbox",id:"consent",name:"consent",checked:u.consent||!1,onChange:w,required:!0}),e.jsxs("label",{htmlFor:"consent",className:"consent-text",children:["I agree to receiving appointment confirmations, reminders and marketing communications via email and SMS messages. Msg & data rates may apply. Msg frequency varies. Reply HELP for help and STOP to cancel. View our"," ",e.jsx("a",{href:"/#",children:"Privacy Policy"})]})]}),e.jsx("input",{type:"hidden",name:"areas",value:u.areas}),e.jsx("input",{type:"hidden",name:"conditions",value:u.conditions}),e.jsx("div",{className:"form-actions",children:e.jsx("button",{type:"submit",className:"area-button",disabled:r,children:r?"Submitting...":"COMPLETE CONSULTATION"})})]})]})}):D&&c.length>0?e.jsxs("div",{children:[e.jsx("h3",{className:"quiz-card-header-text",children:"Your Selections"}),c.map(n=>e.jsxs("div",{className:"body-part-section",children:[e.jsx("p",{className:"body-part-name",children:e.jsx("strong",{children:n.area.name})}),n.conditions.length>0?e.jsx("ul",{className:"conditions-list",children:n.conditions.map(s=>e.jsxs("li",{children:[s.title," ",e.jsx("span",{className:"delete-icon",children:"Ã—"})]},s.id))}):e.jsx("p",{className:"no-conditions",children:"No conditions selected"})]},n.area.id)),e.jsx("button",{onClick:$,className:"area-button",disabled:c.reduce((n,s)=>n+s.conditions.length,0)===0,children:"COMPLETE CONSULTATION"})]}):i?r?e.jsx("div",{className:"loading-spinner",children:"Loading quiz data..."}):e.jsxs(e.Fragment,{children:[e.jsx(J,{bodypart:i.name,conditions:j,onSelect:U,selectedConditions:Y()}),j.length>0&&e.jsx("button",{onClick:B,className:"area-button",style:{marginTop:"60px"},children:"ADD TREATMENTS"})]}):e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"quiz-card-header-text",children:"Your Selections"}),e.jsx("span",{className:"quiz-card-desc-text",children:"Start your quiz by clicking on a body part you want to be treated."})]});return e.jsxs(e.Fragment,{children:[!k&&e.jsxs("div",{className:"quiz-main-grid",children:[e.jsx("div",{className:"quiz-content-area",children:e.jsxs("div",{className:"view-toggle-container",children:[e.jsx(_,{areasResponse:l,onSelect:L,selectedAreas:p,isLoading:r,showFrontView:C}),e.jsx("div",{onClick:O,className:"flipper",children:C?"Back":"Front"})]})}),e.jsx("div",{className:"selection-panel",children:R()})]}),k&&e.jsx("div",{className:"submission-section",children:e.jsxs("div",{className:"submission-container",children:[e.jsxs("div",{className:"submission-header",children:[e.jsx("h2",{children:"Your Recommendations Are In!"}),e.jsx("span",{children:"Here is what we suggest based on your skin + body goals:"})]}),e.jsx("div",{className:"recommendations-grid",children:c.map(n=>{const s=n.conditions.flatMap(a=>a.recommended_services||[]);return s.length===0?null:e.jsxs("div",{className:"recommendation-card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{children:n.area.name})}),e.jsx("div",{className:"card-content",children:e.jsx("div",{className:"scroll-area",children:e.jsx("div",{className:"scroll-content",children:s.map(a=>{var t;return e.jsxs("div",{className:"treatment-item",children:[e.jsx("span",{className:"card-badge",children:(t=a.taxonomy[0])==null?void 0:t.name}),e.jsx("h3",{children:a.title}),e.jsx("p",{children:(a==null?void 0:a.description)||"Description..."}),e.jsx("div",{className:"card-separator"})]},a.id)})})})})]},n.area.id)})}),e.jsxs("div",{className:"submission-footer",children:[e.jsx("button",{className:"reset-button",onClick:Q,children:"Take the quiz again"}),e.jsx("button",{className:"book-button",children:"Book Appointment"})]})]})})]})},K=()=>e.jsx("div",{className:"home-page",children:e.jsx("main",{className:"main-content",children:e.jsx("section",{className:"quiz-container-section",children:e.jsx("div",{className:"quiz-wrapper",children:e.jsx(W,{})})})})});export{K as default};
